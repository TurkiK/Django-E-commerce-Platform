{% extends 'base.html' %}

{% block cart_count %}
    {% if cart_items %}
        <!-- Display the cart item count if available -->
        <div class="font-bold">{{ cart_items|length }}</div>    
    {% endif %}
{% endblock %}

{% block content %}
<h2 class="font-bold text-base sm:text-lg md:text-2xl lg:text-4xl mt-6 mb-12">Shopping Cart</h2>
<div class="flex flex-col lg:flex-row justify-between gap-10">
    <div class="flex flex-col basis-2/3">
        <div class="border-t border-gray-300"></div>
        {% for item in cart_items %}
        <div class="flex flex-row gap-8 p-8 text-gray-600">
            <a href="{% url 'product_detail' pk=item.product.pk %}" class="rounded place-self-center h-40"><img src="https://prd.place/250/250?id={{item.product.id}}" alt="{{ item.product.name }}"></a>
            <div class="flex flex-col w-full gap-1">
                <a href="{% url 'product_detail' pk=item.product.pk %}" class="font-medium hover:text-gray-500 hover:underline w-fit">{{ item.product.name }}</a>
                <a href="{% url 'products' category_name=item.product.category.name %}" class="text-gray-500 hover:text-gray-300 hover:underline w-fit">{{item.product.category.name}}</a>
                <span class="font-medium">${{ item.subtotal }}</span>
            </div>
            <span class="font-semibold">{{ item.quantity }}</span>
            <form action="{% url 'remove_from_cart' pk=item.product.pk %}" method="post">
                {% csrf_token %}
                <button type="submit" class="rounded-full text-gray-400 hover:text-gray-300 hover:ring-2 ring-gray-300 px-1 transition duration-150 ease-in-out"><i class="fa-solid fa-xmark"></i></button>
            </form>
        </div>
        <div class="border-t border-gray-300"></div>
        {% empty %}
        <div class="font-semibold text-center mt-4">Your cart is empty.</div>
        {% endfor %}
    </div>
    <div class="basis-1/2">
        <div class="flex flex-col rounded bg-gray-100 text-gray-600 w-full p-8 gap-4">
            <span class="font-semibold mb-2">Order Summary</span>
            <div class="flex flex-row justify-between">
                <span class="">Subtotal</span>
                <span class="">${{ total_price|floatformat:2 }}</span>
            </div>
            <div class="flex-grow border-t border-gray-300"></div>
            <div class="flex flex-row justify-between">
                <span class="">Shipping estimate</span>
                <span class="">$0.00</span>
            </div>
            <div class="flex-grow border-t border-gray-300"></div>
            <div class="flex flex-row justify-between">
                <span class="">Tax estimate</span>
                <span class="">$0.00</span>
            </div>
            <div class="flex-grow border-t border-gray-300"></div>
            <div class="flex flex-row justify-between">
                <span class="font-semibold mb-2">Order Summary</span>
                <span class="">${{ total_price|floatformat:2 }}</span>
            </div>
            {% if cart_items %}
                <a href="{% url 'checkout' %}" class="rounded bg-indigo-500 text-white text-center text-lg md:text-xl font-semibold px-2 py-4 hover:bg-indigo-300 transition duration-150 ease-in-out">Checkout</a>
                <div class="text-center text-sm"><span class="text-gray-500 cursor-default">or</span> <a href="{% url 'home' %}" class="text-indigo-700 hover:text-indigo-300">Continue Shopping <i class="fa-solid fa-arrow-right text-xs"></i></a></div>
            {% else %}
                <a href="{% url 'home' %}" class="rounded bg-indigo-500 text-white text-center text-lg md:text-xl font-semibold px-2 py-4 hover:bg-indigo-300 transition duration-150 ease-in-out">Continue Shopping</a>
            {% endif %}
        </div>
    </div>  
</div>
{% endblock %}
